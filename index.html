<!DOCTYPE html>
<html>
  <!--
     - CIP Reporting Mobile Application
     -
     - Copyright (c) 2013 CIP Reporting
     - All rights reserved.
     - 
     - Redistribution and use in source and binary forms are permitted
     - provided that the above copyright notice and this paragraph are
     - duplicated in all such forms and that any documentation,
     - advertising materials, and other materials related to such
     - distribution and use acknowledge that the software was developed
     - by CIP Reporting.  The name of CIP Reporting may not be used to 
     - endorse or promote products derived from this software without 
     - specific prior written permission.
     -
     - THIS SOFTWARE IS PROVIDED ``AS IS'' AND WITHOUT ANY EXPRESS OR
     - IMPLIED WARRANTIES, INCLUDING, WITHOUT LIMITATION, THE IMPLIED
     - WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.
     -
     -->
  <head>
    <meta charset="utf-8">
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="name" content="CIP Reporting">
    <meta name="description" content="CIP Reporting Mobile Application">
    <meta name="author" content="CIP Reporting">
    <meta name="email" content="support@cipreporting.com">

    <title>CIP Reporting Mobile Application</title>

    <link rel="shortcut icon" href="./res/favicon.ico" type="image/x-icon" />
    <link rel="icon" href="./res/favicon.ico" type="image/x-icon" />

    <!-- Bootstrap CSS, then CIP, then customer provided -->
    <link rel="stylesheet" href="./modules/json-form-engine/lib/alpaca/alpaca.min.css" />
    <link rel="stylesheet" href="./lib/bootstrap/css/bootstrap.min.css" />
    <link rel="stylesheet" href="./lib/summernote/dist/summernote.css" />
    <link rel="stylesheet" href="./lib/font-awesome/css/font-awesome.min.css" />
    <link rel="stylesheet" href="./lib/bootstrap-datetimepicker/bootstrap-datetimepicker.css" />
    <link rel="stylesheet" href="./app/style.css" />
    <link rel="stylesheet" href="./app/spinner.css" />
    <link rel="stylesheet" href="./app/lib/jstree/themes/default/style.min.css" />
    <link rel="stylesheet" href="./app/customize/css/custom.css" />

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="./lib/html5shiv.js"></script>
      <script src="./lib/respond.min.js"></script>
    <![endif]-->
  </head>
  <body>
    <!-- For extra long rendering time pages this can be displayed for improved user experience -->
    <div style="display: none;" id="loading" class="loading">Loading&#8230;</div>
    
    <div id="container">
      <div class="initializing">
        <img src="./res/logo_mono_blue_thin.png" />
        <img src="./res/progress-bar.gif" />
        <p class="lead">Please wait, Initializing...</p>
      </div>
    </div>
    <div id="cipapi-inpage-logger"></div>
    <div id="cipapi-screen-overlay"></div>
    
    <!-- Phonegap / Cordova and Plugins -->
    <script src="cordova.js"></script>
    <script src="js/plugins/LaunchMyApp.js"></script>
    
    <!-- Use console.re for console monitoring - do not enable in production! -->
    <script src="https://console.re/connector.js" data-channel="cip-reporting-mobile-application" id="consolerescript"></script>
    
    <!-- External librarys - jQuery, Bootstrap, etc. -->
    <script src="./lib/jquery-1.11.1.min.js"></script>
    <script src="./lib/jsonform-bootstrap3/deps/underscore.js"></script>
    <script src="./lib/jsonform-bootstrap3/deps/opt/jsv.js"></script>
    <script src="./lib/moment.js"></script>
    <script src="./lib/bootstrap-datetimepicker/bootstrap-datetimepicker.js"></script>
    <script src="./lib/jquery.actual.js"></script>
    <script src="./lib/jquery.image-scale.js"></script>
    <script src="./modules/json-form-engine/lib/handlebars/handlebars.min.js"></script>
    <script src="./lib/bootstrap/js/bootstrap.min.js"></script>
    <script src="./lib/bootbox.min.js"></script>
    <script src="./modules/json-form-engine/lib/alpaca/alpaca.modified.js"></script>
    <script src="./lib/holder.js"></script>
    <script src="./lib/sprintf.js"></script>
    <script src="./lib/jsonform-bootstrap3/lib/jsonform.js"></script>
    <script src="./lib/summernote/dist/summernote.js"></script>
    <script src="./lib/cryptoJS/rollups/sha1.js"></script>
    <script src="./lib/pagedown/Markdown.Converter.js"></script>
    <script src="./lib/purl.js"></script>
    <script src="./lib/jQueryRotate.js"></script>
    <script src="./lib/base64.js"></script>
    <script src="./lib/jquery.floatThead.js"></script>
    <script src="./lib/lz-string.min.js"></script>
    
    <!-- CIP CORS API Interface -->
    <script src="./CIPAPI/logger.js"></script>
    <script src="./CIPAPI/stats.js"></script>
    <script src="./CIPAPI/credentials.js"></script>
    <script src="./CIPAPI/config.js"></script>
    <script src="./CIPAPI/router.js"></script>
    <script src="./CIPAPI/rest.js"></script>
    <script src="./CIPAPI/batch.js"></script>
    <script src="./CIPAPI/timing.js"></script>
    <script src="./CIPAPI/settings.js"></script>
    <script src="./CIPAPI/me.js"></script>
    <script src="./CIPAPI/forms.js"></script>
    <script src="./CIPAPI/mime.js"></script>
    <script src="./CIPAPI/translations.js"></script>
    <script src="./CIPAPI/uuid.js"></script>
    <script src="./CIPAPI/fielddeps.js"></script>

    <!-- Application Screens -->
    <script src="./CIPAPI/screens/logout.js"></script>
    <script src="./app/screens/login.js"></script>
    <script src="./app/screens/main.js"></script>
    <script src="./app/screens/diagnostics.js"></script>
    <script src="./app/screens/logger.js"></script>
    <script src="./app/screens/help.js"></script>
    <script src="./app/screens/settings.js"></script>
    <script src="./app/screens/inventory.js"></script>
    <script src="./app/screens/olbutton.js"></script>
    <script src="./app/screens/jsonform.js"></script>

    <!-- Application Libraries -->
    <script src="./app/lib/storage.memory.js"></script>
    <script src="./app/lib/storage.file.js"></script>
    <script src="./app/lib/storage.sqlite.js"></script>
    <script src="./app/lib/storage.js"></script>
    <script src="./app/lib/mobileforms.js"></script>
    <script src="./app/lib/reportstore.js"></script>
    <script src="./app/lib/images.js"></script>
    <script src="./app/lib/help.js"></script>
    <script src="./app/lib/geolocation.js"></script>
    <script src="./app/lib/device.js"></script>
    <script src="./app/lib/navbar.js"></script>
    <script src="./app/lib/casestore.js"></script>
    <script src="./app/lib/dynamiccss.js"></script>
    <script src="./app/lib/barcode.js"></script>
    <script src="./app/lib/filesize.js"></script>
    <script src="./app/lib/behaviors.js"></script>
    <script src="./app/lib/contextmenu.js"></script>
    <script src="./app/lib/fastclick.js"></script>
    <script src="./app/lib/hammer.js"></script>
    <script src="./app/lib/jquery.hammer.js"></script>
    <script src="./app/lib/usersettings.js"></script>
    <script src="./app/lib/jSignature.min.js"></script>
    <script src="./app/lib/signature.js"></script>
    <script src="./app/lib/inventories.js"></script>
    <script src="./app/lib/elasticlunr.js"></script>
    <script src="./app/lib/jstree/jstree.min.js"></script>
    <script src="./app/lib/online.js"></script>
    <script src="./app/lib/context.js"></script>
    <script src="./app/lib/resume.js"></script>
    
    <!-- Customer Provided -->
    <script src="./app/customize/js/custom.js"></script>

    <!-- Kick it off! -->
    <script type="text/javascript">
      // Default Configurations - which can be overriden by an integration
      CIPAPI.config.setDefaults({
              applicationVersion: '9.0.28',                     // Set by the packaging script to know our own version
             overrideIntegration: 'cip-reporting-mobile-application', // Name of integration to request for configuration override / merge
          reloadSettingsInterval: 'cipapi-timing-1day',               // How often to reload settings from the server
                reloadMeInterval: 'cipapi-timing-1day',               // How often to reload the current user info from the server
            reloadConfigInterval: 'cipapi-timing-1day',               // How often to reload the configuration override from the server
             sendReportsInterval: 'cipapi-timing-1min',               // How often to passively try and send reports
                   thumbMaxWidth: '128px',                            // Thumbnail for attachments maximum width
                  thumbMaxHeight: '128px',                            // Thumbnail for attachments maximum height
                   persistConfig: true,                               // Store config in local storage to avoid start up network access
                 persistSettings: true,                               // Store settings in local storage to avoid start up network access
                       persistMe: true,                               // Store config in local storage to avoid start up network access
                    persistForms: true,                               // Store forms in local storage to avoid start up network access
        persistFieldDependencies: true,                               // Store field dependency in local storage to avoid start up network access
             persistTranslations: true,                               // Store translations in local storage to avoid start up network access
              persistInventories: true,                               // Store inventories in local storage to avoid start up network access
                notifyReportSync: true,                               // Show bootbox notification when reports are successfully sync'd to the server
                   usePreciseGPS: false,                              // Use precise GPS tracking or false for location approximation
                    useSingleURL: false,                              // Use a single API URL for config and form interactions
                    caseModeForm: false,                              // Can be set to the name of a form to put the mobile application into case mode
                caseModeSyncForm: false,                              // Can be set to a form name to request which should respond with open cases
                      dynamicCSS: false,                              // Can be provided by server configuration to be injected into the application
                  devEnvironment: false,                              // Can be provided by server configuration to include mobile friendly marker for dev environment
            enableBarcodeScanner: false,                              // Can be provided by server configuration to enable bar code scanning
              caseModeListFields: [],                                 // The name of the field(s) to display for a case listing
          caseModeAlwaysShowForm: false,                              // If true, a case will always show at least 1 of any known form (except hidden)
          caseOnlyCompleteIfDone: false,                              // If true, all forms must be complete within a case before it can be ended
          storageFailSafeTimeout: 30000,                              // Number of MS to wait for storage to readback and initialize, 0 disables
                  swipeThreshold: 10,                                 // Number of pixels required to recognize a swipe
                   swipeVelocity: 0.3,                                // Swipe velocity required in PX per MS
                   swipeDebounce: 750,                                // Swipe debounce in MS, 0 for no debounce
                    defaultRoute: 'main',                             // Default route to main screen
                    helpOverride: false,                              // Set to custom help markdown or HTML
               forceBarcodeLogin: false,                              // Set to true to only allow barcode login on the login screen
                    lockOnResume: false,                              // Forces a lock screen on resume event if NOT false, true = always, integer = seconds of debounce
               forceLogoutOnLock: false,                              // Forces a full logout instead of lock if the lock screen is triggered
                     hiddenForms: [],                                 // The name of any forms to be hidden (Do not show buttons on the form list page)
                     hiddenMenus: [],                                 // The name of any menus to be hidden (Top level menu)
                 additionalMenus: [],                                 // Additional menus to display to logged in users
                     inventories: { },                                // Collection of inventories to load from the server
                   onlineButtons: { },                                // Collection of online CIPS buttons (requires internet)
                       jsonForms: { },                                // Collection of JSON forms
                        apiForms: { }                                 // Should most likely be loaded from the config override integration
                                                                      // In the form of the key is the form integration and the value is the
                                                                      // friendly name to display on the button.  The order controls the order
                                                                      // of the buttons.  Example:
                                                                      //
                                                                      // apiForms: { 'Test Form': 'Create a Test Form', 'New Form': 'Create a New Form' }
      });

      // Enable fast click
      $(function() { FastClick.attach(document.body); });
      
      // Are we running in native app or in a browser?
      $(document).ready(function() {
        // Disable the context menu
        $('body').attr('oncontextmenu', 'return false;');
        
        if (window.cordova) {
          document.addEventListener("deviceready", function() { 
            // Initialize
            $('body').addClass('cordova');
            $(document).trigger('cipapi-init'); 
          }, false);
        } else {
          // Regular browser - just initialize
          $(document).trigger('cipapi-init');
        }
      });

    </script>
  </body>
</html>
